用一条SQL语句查询出每门课都大于80分的学生姓名

两道sql题：

1、用一条SQL语句查询出每门课都大于80分的学生姓名。

2、删除除了自动编号不同，其他都相同的学生冗余信息。

第一题数据如下：



分析：每门课都大于80分，就是说学生最低分数要大于80分,我们直观看只有"王五"这个学生每门课分数都在80分以上。

解决思路：这里需要用到聚合函数min(score)，查询出最低分数大于80分的学生即可。使用了聚合函数，条件就需要使用having语句。

第一步，查询姓名，最低分数。



第二步，这里只能查询出最低分数的那个人。需要改进，根据用户名分组(group by name)，这样就能查询出每个人的最低分数。



第三步，查询出了每个人的最低分数，我们只需要得到最低分数大于80的学生。通过having语句来筛选。



第四步，我们得到了"王五"的信息，满足我们的要求，但是不是最终的需求，最终的需求是得到每门课大于80分的学生姓名。这样，我们需要再嵌套一个语句，只得到姓名。



最终SQL：select name from (select name,min(score) from student group by name having min(scor

e)>80) stu;

第二题数据如下：



分析：直观的看，我们需要删除id=3的学生信息，因为这条信息和id=1的重复了。这里只是一个示例，实际可能会有很多这样的重复学生信息，我们需要通过语句来找到这些重复的信息，然后删除。

解决思路：直接找冗余的学生信息，是不可能的，我们需要改变思路，找到学生唯一信息，这样，剩下的就是学生冗余信息。这里需要用到not in，关键在于怎么找到学生唯一信息。

找唯一信息，我们知道可以通过distinct关键字，但是这里不符合这样的场景。

另外通过group by分组，可以得到唯一信息，这里需要对除了id编号之外，所有的字段分组。



这里再通过where id not in条件语句就能删除冗余学生信息了。



最终SQL：delete from student2 where id not in (select a.id from (select id from student2 group by no,name,coursename,courseno,score) a);
————————————————
版权声明：本文为CSDN博主「luffy5459」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/feinifi/article/details/80279897