git合并多次提交为一次提交

在实际开发工作中，很少有一次提交git就达成目标的情况，往往是需要多次修改提交，那么多次提交git，在合并到master分支的时候，会过于零碎，为了让代码提交历史更加清晰，需要合并这些零零碎碎的提交履历。

方法一、拉去新的分支，使用squash命令
步骤如下：

a. 在开发新功能或者修复bug的时候，可以从master分支上拉去一个新的分支，分支名可以用功能名来创建。格式如：master_xxxbug_20200414（从哪个分支拉去的，什么bug的修复，什么时候创建的分支）

b. 在新创建的分支，如master_xxxbug_20200414中进行开发，期间可以有多次提交。

c. 开发完成后，并测试通过，确认代码没有问题后，切换到主分支master，使用命令，如下：

git merge --squash [branch name]
将新创建分支的修改全部合并过来，这个时候，代码只是进行了合并，并没有实际commit。

d. 使用如下命令，提交合并代码到本地仓库，如下：

git commit -m "message"
这样，就把在分支里做的全部修改合并成一次提交。

e. 合并之后，在把新拉去的分支删除

总结：
这种情况适用保持master分支提交干净，不会出现零碎的提交历史。多次提交的历史，分摊在了新拉去的分支上面。

方法二、使用git rebase命令
步骤如下：

a. 使用git log命令查看提交历史，按照提交历史倒排序，即，最近的提交在第一个。

git 提交历史
现在要将如下两个版本进行合并：

a56cfe42c90a92c3d44282e3832c1ddb08b36dab
c7d55944427678101a9827c33de30037de7b410e
b. 使用命令git rebase -i c7d55944427678101a9827c33de30037de7b410e，当然也可以使用这个版本号的前8位，git rebase -i c7d55944


解释：
pick 的意思是要执行这个 commit
squash 的意思是这个 commit 会被合并到前一个 commit

c. git 会压缩提交历史，若有冲突，需要进行修改，修改的时候保留最新的历史记录，修改完之后输入以下命令：

git add .
git rebase --continue
若想退出放弃此次压缩，执行命令：

git rebase --abort
d. 若无冲突或冲突已修复，则会出现一个 commit message 编辑页面，修改 commit message ，然后 输入:wq保存退出。

e.同步到远程 git 仓库

git push -f or git push --force
查看远程仓库效果，多次 commit 已被合并成一次 commit。

总结：
git rebase命令可以将多次commit合并，只保留一次提交历史记录。但是这种操作比较复杂，没有方法一中方便。当然，可以按照自己的git使用习惯来。

作者：秋慕云
链接：https://www.jianshu.com/p/68a55caa4501
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
